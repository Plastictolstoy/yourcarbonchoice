<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YourCarbonChoice</title>
    <link rel="stylesheet" href="styles.css"> <!-- 모든 스타일을 외부 CSS 파일로 이동 -->
</head>

<body>
    <header>
        <h1>YourCarbonChoice</h1>
    </header>
    <main>
        <nav>
            <a href="Transport.html"><button>Transport</button></a>
            <a href="AirTravel.html"><button>Air Travel</button></a>
            <a href="Heating & Cooling.html"><button>Heating & Cooling</button></a>
            <a href="Hot water.html"><button>Hot Water</button></a>
            <a href="Clothes_Dryer.html"><button>Clothes dryer</button></a>
            <a href="Lighting.html"><button class="active">Lighting</button></a>
            <a href="Refrigerator.html"><button>Refrigerator</button></a>
            <a href="Cooking.html"><button>Cooking</button></a>
            <a href="Appliances.html"><button>Appliances</button></a>
            <a href="Food & Shopping.html"><button>Food & Shopping</button></a>
            <a href="Waste.html"><button>Waste</button></a>
        </nav>
        <section id="emission-display">
            <div id="emission-info">
                <div id="emission-header">
                    <button class="addButton">+</button>
                    <span class="module-title">Lighting</span>
                    <button id="infoButton">?</button>
                </div>
                <div class="green-line"></div>
                <div class="ghg-display">
                    <span>My household's GHG emissions:</span>
                    <div class="ghg-bar my-ghg">
                        <progress id="emission-gauge" value="0" max="10"></progress>
                    </div>
                </div>
                <div class="ghg-display">
                    <span>A typical household's GHG emissions:</span>
                    <div class="ghg-bar typical-ghg"></div>
                </div>
                <div class="ghg-display">
                    <span>A green household's GHG emissions:</span>
                    <div class="ghg-bar green-ghg"></div>
                </div>
            </div>
            <div class="ghg-total">
                <div id="total-emissions" class="ghg-number">0.00</div>
                <span class="ghg">Tonnes GHG</span>
            </div>
        </section>
        <section id="calculator">
            <div class="calculator-buttons">
                <button class="tablinks" onclick="openTab(event, 'Quick')">Quick</button>
                <button class="tablinks" onclick="openTab(event, 'Detailed')">Detailed</button>
            </div>

            <h1>Lighting Emissions Calculator</h1>
            
            <div id="Quick" class="tabcontent">
                <div>
                    <h3>How many light globes are switched on throughout the house?</h3>
                    <div class="quick-calculation">
                        <div class="light-item">
                            <img src="Incandescent.png" alt="Incandescent">
                            <div>
                                <div class="light-type">INCANDESCENT</div>
                                <div class="dropdown-container">
                                    <label for="incandescent-count">How many?</label>
                                    <select id="incandescent-count">
                                        <option value="none">None</option>
                                        <option value="some">Some</option>
                                        <option value="many">Many</option>
                                    </select>
                                </div>
                                <div class="dropdown-container">
                                    <label for="incandescent-hours">How many hours per day?</label>
                                    <select id="incandescent-hours">
                                        <option value="0">0</option>
                                        <option value="1">1</option>
                                        <option value="2">2</option>
                                        <option value="3">3</option>
                                        <option value="4">4</option>
                                        <option value="5">5</option>
                                        <option value="6">6</option>
                                        <option value="7">7</option>
                                        <option value="8">8</option>
                                        <option value="9">9</option>
                                        <option value="10">10</option>
                                        <option value="11">11</option>
                                        <option value="12">12</option>
                                        <option value="13">13</option>
                                        <option value="14">14</option>
                                        <option value="15">15</option>
                                        <option value="16">16</option>
                                        <option value="17">17</option>
                                        <option value="18">18</option>
                                        <option value="19">19</option>
                                        <option value="20">20</option>
                                        <option value="21">21</option>
                                        <option value="22">22</option>
                                        <option value="23">23</option>
                                        <option value="24">24</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <div class="light-item">
                            <img src="Halogen.png" alt="Halogen">
                            <div>
                                <div class="light-type">LOW VOLTAGE HALOGEN</div>
                                <div class="dropdown-container">
                                    <label for="halogen-count">How many?</label>
                                    <select id="halogen-count">
                                        <option value="none">None</option>
                                        <option value="some">Some</option>
                                        <option value="many">Many</option>
                                    </select>
                                </div>
                                <div class="dropdown-container">
                                    <label for="halogen-hours">How many hours per day?</label>
                                    <select id="halogen-hours">
                                        <option value="0">0</option>
                                        <option value="1">1</option>
                                        <option value="2">2</option>
                                        <option value="3">3</option>
                                        <option value="4">4</option>
                                        <option value="5">5</option>
                                        <option value="6">6</option>
                                        <option value="7">7</option>
                                        <option value="8">8</option>
                                        <option value="9">9</option>
                                        <option value="10">10</option>
                                        <option value="11">11</option>
                                        <option value="12">12</option>
                                        <option value="13">13</option>
                                        <option value="14">14</option>
                                        <option value="15">15</option>
                                        <option value="16">16</option>
                                        <option value="17">17</option>
                                        <option value="18">18</option>
                                        <option value="19">19</option>
                                        <option value="20">20</option>
                                        <option value="21">21</option>
                                        <option value="22">22</option>
                                        <option value="23">23</option>
                                        <option value="24">24</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <div class="light-item">
                            <img src="Compact.png" alt="Compact">
                            <div>
                                <div class="light-type">COMPACT FLUORESCENT LAMP</div>
                                <div class="dropdown-container">
                                    <label for="cfl-count">How many?</label>
                                    <select id="cfl-count">
                                        <option value="none">None</option>
                                        <option value="some">Some</option>
                                        <option value="many">Many</option>
                                    </select>
                                </div>
                                <div class="dropdown-container">
                                    <label for="cfl-hours">How many hours per day?</label>
                                    <select id="cfl-hours">
                                        <option value="0">0</option>
                                        <option value="1">1</option>
                                        <option value="2">2</option>
                                        <option value="3">3</option>
                                        <option value="4">4</option>
                                        <option value="5">5</option>
                                        <option value="6">6</option>
                                        <option value="7">7</option>
                                        <option value="8">8</option>
                                        <option value="9">9</option>
                                        <option value="10">10</option>
                                        <option value="11">11</option>
                                        <option value="12">12</option>
                                        <option value="13">13</option>
                                        <option value="14">14</option>
                                        <option value="15">15</option>
                                        <option value="16">16</option>
                                        <option value="17">17</option>
                                        <option value="18">18</option>
                                        <option value="19">19</option>
                                        <option value="20">20</option>
                                        <option value="21">21</option>
                                        <option value="22">22</option>
                                        <option value="23">23</option>
                                        <option value="24">24</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <div class="light-item">
                            <img src="Linear.png" alt="Linear">
                            <div>
                                <div class="light-type">LINEAR OR CIRCULAR FLUORESCENT LAMP</div>
                                <div class="dropdown-container">
                                    <label for="fluorescent-count">How many?</label>
                                    <select id="fluorescent-count">
                                        <option value="none">None</option>
                                        <option value="some">Some</option>
                                        <option value="many">Many</option>
                                    </select>
                                </div>
                                <div class="dropdown-container">
                                    <label for="fluorescent-hours">How many hours per day?</label>
                                    <select id="fluorescent-hours">
                                        <option value="0">0</option>
                                        <option value="1">1</option>
                                        <option value="2">2</option>
                                        <option value="3">3</option>
                                        <option value="4">4</option>
                                        <option value="5">5</option>
                                        <option value="6">6</option>
                                        <option value="7">7</option>
                                        <option value="8">8</option>
                                        <option value="9">9</option>
                                        <option value="10">10</option>
                                        <option value="11">11</option>
                                        <option value="12">12</option>
                                        <option value="13">13</option>
                                        <option value="14">14</option>
                                        <option value="15">15</option>
                                        <option value="16">16</option>
                                        <option value="17">17</option>
                                        <option value="18">18</option>
                                        <option value="19">19</option>
                                        <option value="20">20</option>
                                        <option value="21">21</option>
                                        <option value="22">22</option>
                                        <option value="23">23</option>
                                        <option value="24">24</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="Detailed" class="tabcontent">
                <h2>Detailed Calculation</h2>
                <div class="table-container">
                    <table border="1">
                        <thead>
                            <tr>
                                <th></th>
                                <th>GHGs</th>
                                <th>ID</th>
                                <th>Type</th>
                                <th>Watts</th>
                                <th>Number</th>
                                <th>Summer</th>
                                <th>Winter</th>
                                <th>Dimming</th>
                            </tr>
                        </thead>
                        <tbody id="lighting-table-body"></tbody>
                    </table>
                </div>
                <button onclick="addLight()">Add a light</button>
            </div>
        </section>
        <div class="main-footer-buttons">
            <a href="Main menu.html"><button>Main Menu</button></a>
            <a href="Save.html"><button>Save</button></a>
            <button>Personal</button>
            <button>Report</button>
        </div>
    </main>
    <footer>
        <p>YourCarbonChoice © 2024</p>
    </footer>
    <script>
        /// Quick tab calculations
        const lightEmissionFactors = {
            "none": 0,
            "some": 0.5,
            "many": 1.5
        };

        const incandescentEmissionFactor = 0.06;
        const cflEmissionFactor = 0.02;
        const halogenEmissionFactor = 0.06;
        const fluorescentEmissionFactor = 0.04;

        function calculateQuickEmissions() {
            const incandescentCount = document.getElementById('incandescent-count').value;
            const incandescentHours = parseFloat(document.getElementById('incandescent-hours').value);
            const cflCount = document.getElementById('cfl-count').value;
            const cflHours = parseFloat(document.getElementById('cfl-hours').value);
            const halogenCount = document.getElementById('halogen-count').value;
            const halogenHours = parseFloat(document.getElementById('halogen-hours').value);
            const fluorescentCount = document.getElementById('fluorescent-count').value;
            const fluorescentHours = parseFloat(document.getElementById('fluorescent-hours').value);

            let totalEmissions = 0;
            totalEmissions += lightEmissionFactors[incandescentCount] * incandescentHours * incandescentEmissionFactor;
            totalEmissions += lightEmissionFactors[cflCount] * cflHours * cflEmissionFactor;
            totalEmissions += lightEmissionFactors[halogenCount] * halogenHours * halogenEmissionFactor;
            totalEmissions += lightEmissionFactors[fluorescentCount] * fluorescentHours * fluorescentEmissionFactor;

            document.getElementById('total-emissions').innerText = totalEmissions.toFixed(2);
            document.getElementById('emission-gauge').value = totalEmissions;
        }

        /// Detailed tab calculations
        const detailedEmissionFactors = {
            "ordinary-incandescent": 0.06,
            "low-voltage-halogen": 0.06,
            "compact-fluorescent-downlight": 0.02,
            "led-halogen-replacement": 0.01,
            "compact-fluorescent-lamp": 0.02,
            "linear-or-circular-fluorescent-lamp": 0.04,
            "flood-light": 0.12,
            "other": 0.05
        };

        let lightCount = 1;

        function addLight() {
            const tableBody = document.getElementById('lighting-table-body');
            const id = `L${lightCount++}`;
            const row = document.createElement('tr');

            row.innerHTML = `
                <td><button onclick="removeLight('${id}')">X</button></td>
                <td id="${id}-ghgs" class="ghg-cell">0.00 kg CO2-eq/year</td>
                <td onclick="toggleInput('${id}-id')" id="${id}-id-td"><span>${id}</span><input type="text" id="${id}-id" value="${id}" class="hidden-input"></td>
                <td onclick="toggleInput('${id}-type')" id="${id}-type-td"><span>Ordinary (incandescent)</span><select id="${id}-type" class="hidden-input">
                    <option value="ordinary-incandescent">Ordinary (incandescent)</option>
                    <option value="low-voltage-halogen">Low voltage halogen</option>
                    <option value="compact-fluorescent-downlight">Compact fluorescent downlight</option>
                    <option value="led-halogen-replacement">LED (halogen replacement)</option>
                    <option value="compact-fluorescent-lamp">Compact fluorescent lamp</option>
                    <option value="linear-or-circular-fluorescent-lamp">Linear or circular fluorescent lamp</option>
                    <option value="flood-light">Flood light</option>
                    <option value="other">Other</option>
                </select></td>
                <td onclick="toggleInput('${id}-watts')" id="${id}-watts-td"><span>0</span><input type="number" id="${id}-watts" class="hidden-input" min="0" value="0"></td>
                <td onclick="toggleInput('${id}-number')" id="${id}-number-td"><span>0</span><input type="number" id="${id}-number" class="hidden-input" min="0" value="0"></td>
                <td onclick="toggleInput('${id}-summer')" id="${id}-summer-td"><span>0</span><input type="number" id="${id}-summer" class="hidden-input" min="0" value="0"></td>
                <td onclick="toggleInput('${id}-winter')" id="${id}-winter-td"><span>0</span><input type="number" id="${id}-winter" class="hidden-input" min="0" value="0"></td>
                <td onclick="toggleInput('${id}-dimming')" id="${id}-dimming-td"><span>0</span><input type="number" id="${id}-dimming" class="hidden-input" min="0" max="100" value="0"></td>
            `;

            tableBody.appendChild(row);

            const inputs = row.querySelectorAll('input, select');
            inputs.forEach(input => {
                input.addEventListener('change', () => calculateDetailedEmissions(id));
            });
        }

        function removeLight(id) {
            const row = document.querySelector(`#${id}-ghgs`).closest('tr');
            row.remove();
        }

        function toggleInput(id) {
            const span = document.querySelector(`#${id}-td span`);
            const input = document.getElementById(id);

            document.querySelectorAll('.active').forEach(el => el.classList.remove('active'));
            document.querySelector(`#${id}-td`).classList.add('active');

            if (input.classList.contains('hidden-input')) {
                input.classList.remove('hidden-input');
                span.style.display = 'none';
                input.style.display = 'block';
                input.focus();
            }

            input.addEventListener('blur', () => {
                input.classList.add('hidden-input');
                span.style.display = 'block';
                input.style.display = 'none';
                span.innerText = input.value;
                calculateDetailedEmissions(id.split('-')[0]);
            });
        }

        function calculateDetailedEmissions(id) {
            const type = document.getElementById(`${id}-type`).value;
            const watts = parseFloat(document.getElementById(`${id}-watts`).value);
            const number = parseFloat(document.getElementById(`${id}-number`).value);
            const summerHours = parseFloat(document.getElementById(`${id}-summer`).value);
            const winterHours = parseFloat(document.getElementById(`${id}-winter`).value);
            const dimming = parseFloat(document.getElementById(`${id}-dimming`).value) / 100;

            const emissionFactor = detailedEmissionFactors[type] || 0;

            const Slamphrs = summerHours * 120;
            const Wlamphrs = winterHours * 245;
            const DimlampFactor = (0.86 * dimming + 0.16);

            const totalEmissions = number * watts / 1000 * DimlampFactor * (Slamphrs + Wlamphrs) * emissionFactor * 3.6;

            document.getElementById(`${id}-ghgs`).innerText = totalEmissions.toFixed(2) + " kg CO2-eq/year";
        }

        // add event listener after loading DOM
        document.addEventListener('DOMContentLoaded', () => {
            document.getElementsByClassName('tablinks')[0].click();
            addLight(); // Add initial light row for detailed tab

            document.getElementById('incandescent-count').addEventListener('change', calculateQuickEmissions);
            document.getElementById('incandescent-hours').addEventListener('change', calculateQuickEmissions);
            document.getElementById('cfl-count').addEventListener('change', calculateQuickEmissions);
            document.getElementById('cfl-hours').addEventListener('change', calculateQuickEmissions);
            document.getElementById('halogen-count').addEventListener('change', calculateQuickEmissions);
            document.getElementById('halogen-hours').addEventListener('change', calculateQuickEmissions);
            document.getElementById('fluorescent-count').addEventListener('change', calculateQuickEmissions);
            document.getElementById('fluorescent-hours').addEventListener('change', calculateQuickEmissions);
        });

        function openTab(evt, tabName) {
            const tabcontent = document.getElementsByClassName("tabcontent");
            const tablinks = document.getElementsByClassName("tablinks");

            for (let i = 0; i < tabcontent.length; i++) {
                tabcontent[i].style.display = "none";
            }

            for (let i = 0; i < tablinks.length; i++) {
                tablinks[i].className = tablinks[i].className.replace(" active", "");
            }

            document.getElementById(tabName).style.display = "block";
            evt.currentTarget.className += " active";
        }
    </script>
</body>

</html>